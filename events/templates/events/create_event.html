<!-- create_event.html -->
{% extends "base.html" %}
{% load static %}

{% block title %}
Create Event
{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1>Create Event</h1>
    <div class="progress mb-4">
        <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
    </div>
    <form id="create-event-form" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="form-step">
            <div class="mb-3">
                {{ form.title.label_tag }}
                {{ form.title }}
                <div class="invalid-feedback">
                    Please provide a valid title.
                </div>
            </div>
            <div class="mb-3">
                {{ form.description.label_tag }}
                {{ form.description }}
                <div class="invalid-feedback">
                    Please provide a valid description.
                </div>
            </div>
            <button type="button" class="btn btn-primary" onclick="nextStep()">Next</button>
        </div>
        <div class="form-step" style="display: none;">
            <div class="mb-3">
                {{ form.date.label_tag }}
                {{ form.date }}
                <div class="invalid-feedback">
                    Please provide a valid date.
                </div>
            </div>
            <div class="mb-3">
                {{ form.time.label_tag }}
                {{ form.time }}
                <div class="invalid-feedback">
                    Please provide a valid time.
                </div>
            </div>
            <button type="button" class="btn btn-secondary" onclick="prevStep()">Previous</button>
            <button type="button" class="btn btn-primary" onclick="nextStep()">Next</button>
        </div>
        <div class="form-step" style="display: none;">
            <div class="mb-3">
                {{ form.location.label_tag }}
                {{ form.location }}
                <div class="invalid-feedback">
                    Please provide a valid location.
                </div>
            </div>
            <div class="mb-3">
                {{ form.capacity.label_tag }}
                {{ form.capacity }}
                <div class="invalid-feedback">
                    Please provide a valid capacity.
                </div>
            </div>
            <button type="button" class="btn btn-secondary" onclick="prevStep()">Previous</button>
            <button type="button" class="btn btn-primary" onclick="nextStep()">Next</button>
        </div>
        <div class="form-step" style="display: none;">
            <div class="mb-3">
                {{ form.image.label_tag }}
                {{ form.image }}
                <div class="invalid-feedback">
                    Please provide a valid image.
                </div>
            </div>
            <div class="mb-3">
                {{ form.video.label_tag }}
                {{ form.video }}
                <div class="invalid-feedback">
                    Please provide a valid video.
                </div>
            </div>
            <button type="button" class="btn btn-secondary" onclick="prevStep()">Previous</button>
            <button type="submit" class="btn btn-primary">Create Event</button>
        </div>
    </form>
</div>

<!-- Include TinyMCE from CDN with API key -->
<script src="https://cdn.tiny.cloud/1/ehgfnoldpm58zd26rm85ihmd7yw2vcv2gft0cporiu3pts7j/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
<script>
    tinymce.init({
        selector: 'textarea',  // Change this value according to your HTML
        plugins: 'advlist autolink lists link image charmap print preview hr anchor pagebreak',
        toolbar_mode: 'floating',
        setup: function (editor) {
            editor.on('change', function () {
                editor.save();
            });
        }
    });

    let currentStep = 0;
    const formSteps = document.querySelectorAll('.form-step');
    const progressBar = document.getElementById('progress-bar');

    function updateProgressBar() {
        const progress = (currentStep / (formSteps.length - 1)) * 100;
        progressBar.style.width = progress + '%';
        progressBar.setAttribute('aria-valuenow', progress);
    }

    function showStep(step) {
        formSteps.forEach((formStep, index) => {
            formStep.style.display = index === step ? 'block' : 'none';
        });
        updateProgressBar();
    }

    function nextStep() {
        if (currentStep < formSteps.length - 1) {
            currentStep++;
            showStep(currentStep);
        }
    }

    function prevStep() {
        if (currentStep > 0) {
            currentStep--;
            showStep(currentStep);
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        showStep(currentStep);
    });
</script>
{% endblock %}
